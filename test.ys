// Project Soaring A1
/* Multi-line
comment */

func test() {
    print("Hello, world!\n");
}

println(test());

// 复杂运算测试
println(1 + 2 * 3 / (4 - 5 % (6 ^ 7) & 8 + 7) << 9 >> 10);

func fac(n) {
    if (n == 0) {
        return 1;
    } else {
        return n * fac(n - 1);
    }
}

println(fac(10));

var obj = {
    a: 1,
    l: [1, 2, 3],
    setA: method(self, n) {
        self.a = n;
    },
    getA: method(self) {
        return self.a;
    },
    print: method(self) {
        print("obj: a = ", self.a, " l.type = ", typeof(self.l), "\n");
    },
    print_fn: func(self) {
        print("obj: a = ", self.a, " l.type = ", typeof(self.l), "\n");
    }
};

obj.print();
println(obj.getA());
obj.setA(2);
obj.print();
obj.print_fn(obj);

println(0.2 + 0.1);

var i = 0;
while (1) {
    i = i + 1;
    if (i > 10) {
        break;
    }
    if (i == 5) {
        continue;
    }
    println(i);
}

var fn = func(x, y) { return x + y; };
println(fn(1, 2));

var lst = [];
i = 0;
while (1) {
    i = i + 1;
    if (i > 10) {
        break;
    }
    if (i == 5) {
        continue;
    }
    lst.append(i);
}
lst.extend(lst);
i = 0;
while (i < len(lst)) {
    print(lst[i], " ");
    i = i + 1;
}
println();

var objkeys = obj.keys();
i = 0;
while (i < len(objkeys)) {
    print(objkeys[i], " ");
    i = i + 1;
}
println();

type T {
    a: 10,
    printA: method(self) {
        println("T: a = ", self.a);
    }
}

var t_a = T {};
t_a.printA();
t_a.a = 20;
T.printA(t_a);

println();

var S = type(T) {
    a_looooooooooooooooooog_b: 20,
    print: method(self) {
        self.printA();
        println("S: b = ", self.a_looooooooooooooooooog_b);
    }
};

var t_s = S {a: 30};
t_s.print();
S.printA(t_s);

if (1) {
    println(0);
} else if (0) {
    println(1);
} else {
    println(2);
}

func printKeys(obj) {
    print("printKeys for (type = ", typeof(obj), "): ");
    var keys = obj.keys(), i = 0;
    while (i < len(keys)) {
        print(keys[i],  " ");
        i = i + 1;
    }
    println();
}

var obj0 = {a: 20, b: 10, fn: method(a, b) {printKeys(a); printKeys(b); println(a.a, " ", b.a);}};
var obj1 = {a: 10, c: 30, fn: obj0.fn};
println(1);
printKeys(obj0);
printKeys(obj1);
obj0.fn(obj1);
println(typeof(obj1), " ", typeof(obj1.fn), " ", typeof(obj0.fn));
obj1.fn();

type Point {
    __init__: method(self, y, x) {
        println("self.tp = ", typeof(self), " ", y, " ", x);
        self.y = y;
        self.x = x;
        println(self.y, " ", self.x);
    }
}

var p = Point(10, 20);
println(typeof(p));
println(p.y, " ", p.x);

println(1);
println(2);

type Vec {
    x: 10,
    y: 20,
}

var v = Vec();
println(v.x, " ", v.y);
